<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/bootstrap/bootstrap.css" type="text/css" />
    <link rel="stylesheet" href="css/dh-generalStyle.css" type="text/css" />
    <link rel="stylesheet" href="css/dh-checkSwitch.css" type="text/css" />
    <title>查詢班次時間</title>
    <style type="text/css">
        /* CSS testing*/
        label{
            font-size:16px;    
        }
    </style>
</head>

<body>
    <div class="wrapper">
        <!-- 導覽列 -->
        <nav class="navbar navbar-default  navbar-fixed-top">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand logo" href="index.html">
                        <span><img id="logopic" src="img/bus.svg" style="display:none"/></span>
                    </a>
                    <a class="navbar-brand" id="navtitle" style="display:none" href="index.html">
                        搭客運吧網路訂票系統
                    </a>
                </div>
                <div id="navbar" class="navbar-collapse collapse">
                    <ul class="nav navbar-nav navbar-right">
                        <li><a class="nav-li-a" href="order1.html">網路訂位</a></li>
                        <li><a href="stations.html">各站據點</a></li>
                        <li><a href="news.html">最新消息</a></li>
                        <li><a href="timetable.html">時刻表</a></li>
                        <li><a href="reservedQuery.html">訂位查詢</a></li>
                    </ul>
                </div>
            </div>
        </nav>
        
        <!-- Main Content -->
        <div class="mainContent" style='display:none;'>
            <!--Section1-->
            <div class="container container-1">
                <!-- 訂票流程 -->
                <div class="container" id="progressbar">
                    <div class="row text-center progressbar">
                        <ul class="list-inline list-group" id="progress1">
                            <li class="progressbar-item progressbar-selected">選擇日期站點</li>
                            <li class="progressbar-item">選擇班次</li>
                            <li class="progressbar-item">購票須知</li>
                            <li class="progressbar-item">選擇座位</li>
                            <li class="progressbar-item">訂票完成</li>
                        </ul>
                        <ul class="list-inline list-group" id="progress2">
                            <li class="progressbar-item progressbar-selected">1</li>
                            <li class="progressbar-item">2</li>
                            <li class="progressbar-item">3</li>
                            <li class="progressbar-item">4</li>
                            <li class="progressbar-item">5</li>
                        </ul>
                    </div>
                </div>
            <!-- 表單區 -->
            <form class="container" method="post" action="order2.html" id="form1" onsubmit="return checkForm1()">
            
            <div class="row col-sm-12">
                <!-- 單程/去程 -->
                <div class="form-group col-sm-12">
                    <div class="onoffswitch">
                        <input type="checkbox" name="tripType" class="onoffswitch-checkbox" id="tripTypeSwitch">
                        <label class="onoffswitch-label" for="tripTypeSwitch">
                            <span class="onoffswitch-inner"></span>
                            <span class="onoffswitch-switch"></span>
                        </label>
                    </div>
                    <!--<label for="oneway">單程票</label>-->
                    <!--<input type="radio" name="tripType" id="oneway" value="oneway" checked="true"/>-->
                    <!--<label for="return">來回票</label>-->
                    <!--<input type="radio" name="tripType" id="return" value="return" />-->
                </div>
            </div>
            
            <div class="row col-sm-12">
                <!-- 去程日期選擇 -->
                <div class="form-group col-sm-6 text-left">
                    <label for="depDate" class="control-label"><span class="glyphicon glyphicon-calendar" aria-hidden="true"></span>  去程日期</label>
                    <select class="form-control  dateOption" id="depDate" name="depDate">
                        <option value="null" selected="selected">請選擇去程日期</option>
                    </select>
                </div>
                <div class="form-group col-sm-6 text-left">
                    <label for="depTime" class="control-label"><span class="glyphicon glyphicon-time" aria-hidden="true"></span>  搭乘時段</label>
                    <select class="form-control" id="depTime" name="depTime">
                            <option value="null">請選擇乘車時段</option>
                            <option value="1">00:00~02:59</option>
                            <option value="2">03:00~05:59</option>
                            <option value="3">06:00~08:59</option>
                            <option value="4">09:00~11:59</option>
                            <option value="5">12:00~14:59</option>
                            <option value="6">15:00~17:59</option>
                            <option value="7">18:00~20:59</option>
                            <option value="8">21:00~23:59</option>
                    </select>
                </div>
            </div>
            <div class="row col-sm-12">
                <div class="form-group col-sm-6 text-left">
                    <label for="departSite" class="control-label"><span class="glyphicon glyphicon-home" aria-hidden="true"></span>  上車站</label>
                    <select class="form-control" id="departSite" name="departSite">
                            <option value="null">請選擇上車站</option>
                            <optgroup label="北部地區">
                                <option value="0001">台北轉運站</option>
                                <option value="0002">市府轉運站</option>
                                <option value="0003">景美站</option>
                                <option value="0004">重陽站</option>
                                <option value="0005">板橋站</option>
                            </optgroup>
                            <optgroup label="中部地區">
                                    <option value="006">台中車站</option>
                                    <option value="007">朝馬站</option>
                                    <option value="008">彰化站</option>
                                    <option value="009">員林轉運站</option>
                                    <option value="0010">南投站</option>
                            </optgroup>
                            <optgroup label="南部地區">
                                    <option value="0011">虎尾站</option>
                                    <option value="0012">嘉義轉運站</option>
                                    <option value="0013">新營站</option>
                                    <option value="0014">建國站</option>
                                    <option value="0015">楠梓站</option>
                            </optgroup>
                    </select>
                </div>
                <div class="form-group col-sm-6 text-left">
                    <label for="arriveSite" class="control-label"><span class="glyphicon glyphicon-heart" aria-hidden="true"></span>  下車站</label>
                    <select class="form-control" id="arriveSite" name="arriveSite">
                            <option value="null">請選擇下車站</option>
                            <optgroup label="北部地區">
                                <option value="0001">台北轉運站</option>
                                <option value="0002">市府轉運站</option>
                                <option value="0003">景美站</option>
                                <option value="0004">重陽站</option>
                                <option value="0005">板橋站</option>
                            </optgroup>
                            <optgroup label="中部地區">
                                    <option value="006">台中車站</option>
                                    <option value="007">朝馬站</option>
                                    <option value="008">彰化站</option>
                                    <option value="009">員林轉運站</option>
                                    <option value="0010">南投站</option>
                            </optgroup>
                            <optgroup label="南部地區">
                                    <option value="0011">虎尾站</option>
                                    <option value="0012">嘉義轉運站</option>
                                    <option value="0013">新營站</option>
                                    <option value="0014">建國站</option>
                                    <option value="0015">楠梓站</option>
                            </optgroup>
                    </select>
                </div>
            </div>
            <div class="row col-sm-12" id="returnSection" style="display:none;">
                <div class="form-group col-sm-6 text-left">
                    <label for="returnDate" class="control-label"><span class="glyphicon glyphicon-calendar" aria-hidden="true"></span>  回程日期</label>
                    <select class="form-control dateOption" id="returnDate" name="returnDate">
                        <option value="null">請選擇回程日期</option>
                    </select>
                </div>
                <div class="form-group col-sm-6 text-left">
                    <label for="returnTime" class="control-label"><span class="glyphicon glyphicon-time" aria-hidden="true"></span>  搭乘時段</label>
                    <select class="form-control" id="returnTime" name="returnTime">
                            <option value="null">請選擇乘車時段</option>
                            <option value="1">00:00~02:59</option>
                            <option value="2">03:00~05:59</option>
                            <option value="3">06:00~08:59</option>
                            <option value="4">09:00~11:59</option>
                            <option value="5">12:00~14:59</option>
                            <option value="6">15:00~17:59</option>
                            <option value="7">18:00~20:59</option>
                            <option value="8">21:00~23:59</option>
                    </select>
                </div>
            </div>
            <!-- 車票種類 -->
            <div class="row col-sm-12" id="ticketType">
                <div class="form-group col-sm-4 text-left" id="adultSection">
                    <label for="adult" class="control-label">全票</label>
                    <select class="form-control" id="adult" name="adult">
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                    </select>
                </div>
                <div class="form-group col-sm-4 text-left" id="childSection">
                    <label for="child" class="control-label">半票</label>
                    <select class="form-control" id="child" name="child">
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                    </select>
                </div>
                <div class="form-group col-sm-4 text-left" id="discountSection">
                    <label for="discount" class="control-label">優待票</label>
                    <select class="form-control" id="discount" name="discount">
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                    </select>
                </div>
            </div>
            <div class="row col-sm-12">
                <div class="form-group col-sm-12">
                    <button class="btn btn-primary form-control" id="fakeSubmit" onclick="fakeSubmit()">送出查詢</button>
                    <!-- <input type="submit" value="送出查詢" class="btn btn-primary form-control" /> -->
                </div>
            </div>
        </form>
            </div>
        </div>
        <div id="snackbar"></div>
        <!--Footer-->
        <footer class="footer">
            <div class="container text-center">
                <div class="row">
                    <div class="col-sm-12">
                        <br>
                        <span>免費客服 0800-000-000 搭客運吧 © 版權所有 Copyright © 2018 All Rights Reserved.</span>
                        <br>
                        <span>本網站為資策會養成班結訓專題作品，引用圖文若有侵犯您的著作權，煩請來信告知以利將資料移除，謝謝！</span>
                    </div>
                </div>
            </div>
        </footer>
    </div>
    
    
    <!--JS for general usage-->
    <!--<script type="text/javascript" src="js/jquery3.3.1.js"></script>-->
    <script type="text/javascript" src="js/jquery/jquery-1.12.4.min.js"></script>
    <script type="text/javascript" src="js/bootstrap/bootstrap.js"></script>
    
    
    <!--JS for DateTimePickerPlugin-->
    <script type="text/javascript" src="js/datepicker/moment-with-locales.js"></script>
    <script type="text/javascript">
    $('document').ready(function() {
        // 頁面載入動畫
        $('#logopic').toggle(1000, function(){
            $('#navtitle').fadeIn(1000);
            });
        $('.mainContent').fadeIn(1000);
        
        
        // 動態加入去回程日期選項
        loadDateOptions();
    });
    
    // 切換單程來回
    $("[name='tripType']").on("click", function(){
        if (!$(this).prop("checked")) {
            // 單程
            $('#returnSection').toggle(1000);
            $('#discountSection').fadeIn();
            $('#childSection').fadeIn();
            
        } else {
            // 來回
            $('#returnSection').toggle(1000);
            $('#discountSection').fadeOut();
            $('#childSection').fadeOut();
            $('#child').prop('value','0');
            $('#discount').prop('value','0');
            }
        });
        
        
    // 產生去回程日期選項
    // 利用moment.js&jquery
    function loadDateOptions(){
        for (i=1;i<15;i++) {
            var date = moment().locale('zh-tw').add(i-1, 'days').format('L');
            var days = moment().locale('zh-tw').add(i-1, 'days').format('dddd');
            $('.dateOption').append('<option>'+ date + ' ' + days  +'</option>').text();
            $('.dateOption option:eq('+ i +')').attr('value', date);
        }
    }
    
    // Snackbar
    function showSnackbar(message) {
        $('#snackbar').addClass('show');
        $('#snackbar').text(message);
        setTimeout(function() {
        $('#snackbar').prop('class', '');
        }, 3000);
    }
    
    // 驗證訂票數量
    function checkTicketsAmount(){
        var isOK = false;
        // 訂票數量驗證
        var adult = $('#adult option:selected').val();
        var child = $('#child option:selected').val();
        var discount = $('#discount option:selected').val();
        var total = parseInt(adult) + parseInt(child) + parseInt(discount);
        if ( total > 4) {
            showSnackbar("訂票總數限定4張, 請重新選取。")
            console.log(total);
        } else if (total == 0){
            showSnackbar("票券數量不得為零");
            console.log(total);
        } else {
            console.log(total);
            isOK = true;
        }
        return isOK;
    }

    // 去回程欄位驗證
    function checkInputs(){
        // 去回程欄位驗證
        var isChecked = true;
        if ($('#departSite option:selected').val() == "null") {
            showSnackbar('請選擇上車站');
            isChecked = false;
        } else if ($('#arriveSite option:selected').val() == "null") {
            showSnackbar('請選擇下車站');
            isChecked = false;
        } else if ($('#departSite option:selected').val() == $('#arriveSite option:selected').val()){
            showSnackbar('上下車站不可相同');
            isChecked = false;
        }

        if ($('#depDate option:selected').val() == "null"){
            showSnackbar('請選擇去程日期');
            isChecked = false;
        } else if ($('#depTime option:selected').val() == "null"){
            showSnackbar('請選擇乘車時段');
            isChecked = false;
        } 

        if ($('#tripTypeSwitch').prop('checked')){
            // 來回票檢查
            if ($('#returnDate option:selected').val() == "null"){
                showSnackbar('請選擇回程日期');
                isChecked = false;
            } else if ($('#returnTime option:selected').val() == "null"){
                showSnackbar('請選擇乘車時段');
                isChecked = false;
            } 
        }


        return isChecked;
    }


    // 檢查表單
    function checkForm1(){
        console.log('checkForm1');
        isOK = false
        
        if (checkInputs() && checkTicketsAmount()){
            isOK = true;
        }
        return isOK;
    }

    function fakeSubmit(){
        if (checkForm1()){
            window.location = "order2.html";
        }
    }
    
    
    </script>
</body>

</html>
